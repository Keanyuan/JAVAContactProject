<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<script type="text/javascript" src="../js/PrintLog.js" ></script>
		<script type="text/javascript" src="../js/ArrayTools.js" ></script>
		<script type="text/javascript" src="../js/StringTools.js" ></script>
		<!--<link rel="stylesheet" type="text/css" href="../css/Table.css"/>-->
		<style type="text/css">
			@import url("../css/Table.css");
		</style>
		<title>创建表格</title>
	</head>
	<body>
		<script type="text/javascript">
			function creatTa(){
				var oTableNode = document.createElement("table");
				var oTbodyNode = document.createElement("tbody");
				var oTrNode = document.createElement("tr");
				var oTdNode =document.createElement("td");
				oTdNode.innerHTML = "这是一个单元格";
				oTrNode.append(oTdNode);
				oTbodyNode.appendChild(oTrNode);
				oTableNode.appendChild(oTbodyNode);
				document.getElementsByTagName("div")[0].appendChild(oTableNode);
			}
			function creatTable(){
				var oTableNode = document.createElement("table");
				oTableNode.id = "tabid";
//				oTableNode.setAttribute("id","tabid");
				var rowVal = parseInt(document.getElementsByName("rowNum")[0].value);
				var colVal = parseInt(document.getElementsByName("cloNum")[0].value);
				for (var x = 1; x <= rowVal; x++) {
					var oTrNode = oTableNode.insertRow();
					for (var m = 1; m <= colVal; m++) {
						var oTdNode = oTrNode.insertCell();
						oTdNode.innerHTML = x + "---" + m;
					}
				}
				document.getElementsByTagName("div")[0].appendChild(oTableNode);
//				document.getElementsByName("crtBtn")[0].disabled = true;
			}
			function delRowClick(){
				var oTableNode = document.getElementById("tabid");
				if (oTableNode == null) {
					alert("表格不存在");
					return;
				}
				var rowVal = parseInt(document.getElementsByName("delrowNum")[0].value);
				if(rowVal < 1 || rowVal > oTableNode.rows.length) {
					alert("要删除的行不存在");
					return;
				}
				oTableNode.deleteRow(rowVal-1);

			}
			function delColClick(){
				var oTableNode = document.getElementById("tabid");
				if (oTableNode == null) {
					alert("表格不存在");
					return;
				}
				var colVal = parseInt(document.getElementsByName("delcloNum")[0].value);
				if (colVal<1 || colVal > oTableNode.rows[0].cells.length) {
					alert("要删除的列不存在");
					return;
				} 
				for (var x =0; x<oTableNode.rows.length; x++) {
					oTableNode.rows[x].deleteCell(colVal-1);
				}
			}
			
		</script>
		行：<input type="text" name="rowNum"/>
		列：<input type="text" name="cloNum"/>
		<input type="button" value="创建表格" onclick="creatTable()" name="crtBtn"/>
		<br />
		<input type="text" name="delrowNum"/><input type="button" value="删除行" onclick="delRowClick()"/>
		<br />
		<input type="text" name="delcloNum"/><input type="button" value="删除列" onclick="delColClick()"/>	
		<hr />
		<div >
			
		</div>
	</body>
</html>
